# ETC介绍及xtoken支持策略

## 1. 以太坊经典（ETC）简介

2016年6月17日下午，黑客攻击了以太坊的众筹项目-The DAO。
这次的漏洞由The DAO智能合同的代码中一个bug引起的，黑客利用精心设计了智能合约，通过间接递归调用，可无限制地把资金转到自己控制的子DAO账号中。
创始人Vitalik在内以太坊核心团队和社区采取以下方案，来纠正黑客的攻击：

* 采用软分叉(soft fork)技术，把The DAO及其子DAO的账号锁定，不允许发生任何交易，相当于冻结了黑客的以太币，使其无法出售获利。软分叉实际上是在以太坊软件中增加临时性的规则（例如不允许某账号转账等），修复一些严重的问题。好处是不影响任何以太坊上已发生的交易，无需回滚区块链的数据，这是任何区块链平台都不可动摇的宪法基石。
* 在软分叉的基础上，实施硬分叉(hard fork)，把黑客账号的以太币重新转回到The DAO手中。这种改动需要永久性修改以太坊的代码，使得所有用户都不承认黑客手上的以太币是有效的，并且相关的以太币要重新记账到The DAO名下。
    
通过修改以太坊软件的代码，在第1920000区块强行把The DAO及其子DAO的所有资金（包括黑客控制的部分）全部转到一个特定的退款合约地址。这个合约唯一的功能就是把众筹人手上的DAO币按照100:1换回原来的以太币。
  
![硬分叉点](/img/etc-info.png)

以太坊分叉后大部分矿工的算力开始支持新链，也有部分算力继续记录原有数据，未修改代码，此链成为以太坊经典，即ETC。自分叉后以太坊同时存在新旧两条链（ETH和ETC），代码相同（除了涉及The DAO的部分），历史账本一样（分叉前），地址的私钥也一样。

## 2. 第三方资源

* ### 2.1 类似以太坊的区块链浏览器etherscan.io，可以全量查询区块链上的所有数据：
  * http://etherhub.io/
  * http://gastracker.io


* ### 2.2 节点服务器，类似提供eth节点服务的infura,使用方法也一致。
  * https://web3.gastracker.io
![节点服务器](/img/etc-gastracker.io.png)

## 3. 钱包关键功能模块设计

* ### 3.1 创建钱包
  
  ![ETH部分架构图](/img/app-eth.png)

  * 图中APP-ETH部分中红色部分在APP本地实现，不需要其他部分参与
  * 因为ETH节点本身没有提供查询‘交易列表’功能，需要自建服务器。具体做法是：从ETH节点上扒取数据，并放入Hbase中，由于数据量非常庞大，这里使用'ES搜索引擎'来加速查找过程。

* ### 3.2 查询余额

  与ETH余额查询一致
  
* ### 3.3 转账

  与ETH余额查询一致

* ### 3.4 交易列表 

  ![以太坊交易列表](/img/eth-txlist.png)

  * 由于以太坊节点本身没有实现查询交易列表功能，需要另外实现该功能，以便前端查询，其中同步程序主要使用web3j来获取以太坊数据


* [web3j][web3j]: 以太坊web3.js的Java版实现，可以认为是以太坊的Java版SDK，用来与以太坊进行交互，Android和后端都可使用


## 4. 参考网址

    [ETC]:https://ethereumclassic.org/
    [geth]:https://github.com/ethereumproject/go-ethereum/
    [web3j]:https://github.com/web3j/web3j

